{"ast":null,"code":"var _jsxFileName = \"/Users/gabriel/code/note-taking/src/components/EditorContainer/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { Editor, EditorState, RichUtils, convertFromRaw, convertToRaw } from 'draft-js';\nimport BlockStyleControls from '../BlockStyleControls';\nimport InlineStyleControls from '../InlineStyleControls';\nimport { EDITOR_STYLE_MAP } from '../../constants';\nimport { CREATE_NOTE, UPDATE_NOTE } from '../../Mutations';\nimport './editor_container.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditorContainer = ({\n  refetch,\n  selectedNote,\n  setSelectedNote\n}) => {\n  _s();\n\n  const editor = useRef(null);\n  const [loading, setLoading] = useState(false);\n  const [successMsg, setSuccessMsg] = useState('');\n  const [errorMsg, setErrorMsg] = useState('');\n  const [editorState, setEditorState] = useState(EditorState.createEmpty());\n  const [createNote] = useMutation(CREATE_NOTE);\n  const [updateNote] = useMutation(UPDATE_NOTE);\n  useEffect(() => {\n    focusEditor();\n  }, []);\n  useEffect(() => {\n    if (selectedNote) {\n      onChange(EditorState.createWithContent(convertFromRaw(JSON.parse(selectedNote.body))));\n    }\n  }, [selectedNote]);\n\n  const focusEditor = () => {\n    editor.current.focus();\n  };\n\n  const onChange = editorState => setEditorState(editorState);\n\n  const toggleBlockType = blockType => {\n    onChange(RichUtils.toggleBlockType(editorState, blockType));\n  };\n\n  const toggleInlineStyle = inlineStyle => {\n    onChange(RichUtils.toggleInlineStyle(editorState, inlineStyle));\n  };\n\n  const getBlockStyle = block => {\n    switch (block.getType()) {\n      case 'blockquote':\n        return 'RichEditor-blockquote';\n\n      default:\n        return null;\n    }\n  };\n\n  const isSubmittable = () => {\n    return convertToRaw(editorState.getCurrentContent()).blocks.some(({\n      text\n    }) => text.trim());\n  };\n\n  const getButtonText = () => {\n    let btnText = '';\n\n    if (loading) {\n      btnText = 'Saving...';\n    } else if (selectedNote) {\n      btnText = 'Update';\n    } else {\n      btnText = 'Save';\n    }\n\n    return btnText;\n  };\n\n  const save = contentState => {\n    const request = {\n      variables: {\n        body: JSON.stringify(contentState)\n      }\n    };\n\n    if (selectedNote) {\n      return updateNote({ ...request,\n        variables: { ...request.variables,\n          id: selectedNote.id\n        }\n      });\n    }\n\n    return createNote(request);\n  };\n\n  const saveNote = async () => {\n    setSuccessMsg('');\n    setErrorMsg('');\n    setLoading(true);\n    const contentState = convertToRaw(editorState.getCurrentContent());\n\n    if (isSubmittable()) {\n      try {\n        await save(contentState);\n        setSuccessMsg('Successfully saved note!');\n        refetch();\n      } catch (e) {\n        console.log(e, 'e');\n        setErrorMsg('Error saving note :(');\n      } finally {\n        setLoading(false);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"flex space-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"ml-1\",\n        children: [selectedNote ? 'Update' : 'Create', \" Note\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), selectedNote && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn primary small\",\n        onClick: () => setSelectedNote(null),\n        children: \"New Note +\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 34\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(BlockStyleControls, {\n      editorState: editorState,\n      onToggle: toggleBlockType\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(InlineStyleControls, {\n      editorState: editorState,\n      onToggle: toggleInlineStyle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Editor, {\n      ref: editor,\n      editorState: editorState,\n      onChange: onChange,\n      blockStyleFn: getBlockStyle,\n      customStyleMap: EDITOR_STYLE_MAP\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"btn-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: loading || !isSubmittable(),\n        className: \"btn primary\",\n        onClick: () => saveNote(),\n        children: getButtonText()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }, this), successMsg && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"success right\",\n      children: successMsg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 28\n    }, this), errorMsg && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error right\",\n      children: errorMsg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 26\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EditorContainer, \"SZy+3N7ide2WghcgD4313QdYeO4=\", false, function () {\n  return [useMutation, useMutation];\n});\n\n_c = EditorContainer;\nexport default EditorContainer;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditorContainer\");","map":{"version":3,"sources":["/Users/gabriel/code/note-taking/src/components/EditorContainer/index.js"],"names":["React","useState","useEffect","useRef","useMutation","Editor","EditorState","RichUtils","convertFromRaw","convertToRaw","BlockStyleControls","InlineStyleControls","EDITOR_STYLE_MAP","CREATE_NOTE","UPDATE_NOTE","EditorContainer","refetch","selectedNote","setSelectedNote","editor","loading","setLoading","successMsg","setSuccessMsg","errorMsg","setErrorMsg","editorState","setEditorState","createEmpty","createNote","updateNote","focusEditor","onChange","createWithContent","JSON","parse","body","current","focus","toggleBlockType","blockType","toggleInlineStyle","inlineStyle","getBlockStyle","block","getType","isSubmittable","getCurrentContent","blocks","some","text","trim","getButtonText","btnText","save","contentState","request","variables","stringify","id","saveNote","e","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { Editor, EditorState, RichUtils, convertFromRaw, convertToRaw } from 'draft-js';\n\nimport BlockStyleControls from '../BlockStyleControls';\nimport InlineStyleControls from '../InlineStyleControls';\n\nimport { EDITOR_STYLE_MAP } from '../../constants';\nimport { CREATE_NOTE, UPDATE_NOTE } from '../../Mutations';\n\nimport './editor_container.css';\n\nconst EditorContainer = ({ refetch, selectedNote, setSelectedNote }) => {\n    const editor = useRef(null);\n    const [loading, setLoading] = useState(false);\n    const [successMsg, setSuccessMsg] = useState('');\n    const [errorMsg, setErrorMsg] = useState('');\n    const [editorState, setEditorState] = useState(\n        EditorState.createEmpty()\n    );\n    const [createNote] = useMutation(CREATE_NOTE);\n    const [updateNote] = useMutation(UPDATE_NOTE);\n\n    useEffect(() => {\n        focusEditor();\n    }, []);\n\n    useEffect(() => {\n        if (selectedNote) {\n            onChange(EditorState.createWithContent(convertFromRaw(JSON.parse(selectedNote.body))))\n        }\n    }, [selectedNote]);\n\n    const focusEditor = () => {\n        editor.current.focus();\n    }\n\n    const onChange = editorState => setEditorState(editorState);\n\n    const toggleBlockType = (blockType) => {\n        onChange(\n            RichUtils.toggleBlockType(\n                editorState,\n                blockType\n            )\n        );\n    }\n\n    const toggleInlineStyle = (inlineStyle) => {\n        onChange(\n            RichUtils.toggleInlineStyle(\n                editorState,\n                inlineStyle\n            )\n        );\n    }\n\n    const getBlockStyle = (block) => {\n        switch (block.getType()) {\n            case 'blockquote': return 'RichEditor-blockquote';\n            default: return null;\n        }\n    }\n\n    const isSubmittable = () => {\n        return convertToRaw(editorState.getCurrentContent()).blocks.some(({ text }) => text.trim())\n    };\n\n    const getButtonText = () => {\n        let btnText = '';\n\n        if (loading) {\n            btnText = 'Saving...'\n        } else if (selectedNote) {\n            btnText = 'Update'\n        } else {\n            btnText = 'Save'\n        }\n\n        return btnText;\n    }\n\n    const save = (contentState) => {\n        const request = {\n            variables: {\n                body: JSON.stringify(contentState)\n            }\n        }\n\n        if (selectedNote) {\n            return updateNote({\n                ...request,\n                variables: {\n                    ...request.variables,\n                    id: selectedNote.id\n                }\n            });\n        }\n\n        return createNote(request);\n    }\n\n    const saveNote = async () => {\n        setSuccessMsg('');\n        setErrorMsg('');\n        setLoading(true);\n        const contentState = convertToRaw(editorState.getCurrentContent());\n        if (isSubmittable()) {\n            try {\n                await save(contentState);\n                setSuccessMsg('Successfully saved note!');\n                refetch();\n            } catch (e) {\n                console.log(e, 'e')\n                setErrorMsg('Error saving note :(')\n            } finally {\n                setLoading(false);\n            }\n        }\n    }\n\n    return (\n        <div>\n            <section className=\"flex space-between\">\n                <h2 className=\"ml-1\">{selectedNote ? 'Update' : 'Create'} Note</h2>\n                {selectedNote && <button className=\"btn primary small\" onClick={() => setSelectedNote(null)}>New Note +</button>}\n            </section>\n            <BlockStyleControls\n                editorState={editorState}\n                onToggle={toggleBlockType}\n            />\n            <InlineStyleControls\n                editorState={editorState}\n                onToggle={toggleInlineStyle}\n            />\n            <Editor\n                ref={editor}\n                editorState={editorState}\n                onChange={onChange}\n                blockStyleFn={getBlockStyle}\n                customStyleMap={EDITOR_STYLE_MAP}\n            />\n            <div className=\"btn-wrapper\">\n                <button disabled={loading || !isSubmittable()} className=\"btn primary\" onClick={() => saveNote()}>{getButtonText()}</button>\n            </div>\n            {successMsg && <p className=\"success right\">{successMsg}</p>}\n            {errorMsg && <p className=\"error right\">{errorMsg}</p>}\n        </div >\n    );\n}\n\nexport default EditorContainer;"]},"metadata":{},"sourceType":"module"}